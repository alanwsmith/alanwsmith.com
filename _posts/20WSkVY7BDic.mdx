---
category: ffmpeg
date: '2021-10-10T14:39:48'
id: 20WSkVY7BDic
slug: /tbd
status: wip
title: Loop Videos For Seamless Audio For Tik Tok With ffmpeg
type: post
---

This is the one that's working nicely

```bash
#!/bin/bash

rm output.mp4

ffmpeg \
-i "test.mp4" \
-filter_complex \
"[0:v]trim=start=0.19:duration=7.66,setpts=PTS-STARTPTS[v0]; \
 [0:a]atrim=start=0.19:duration=7.66,asetpts=PTS-STARTPTS[a0]; \
 [0:v]trim=start=0.19:duration=7.66,setpts=PTS-STARTPTS[v1];
 [0:a]atrim=start=0.19:duration=7.66,asetpts=PTS-STARTPTS[a1]; \
 [0:v]trim=start=0.19:duration=7.66,setpts=PTS-STARTPTS[v2];
 [0:a]atrim=start=0.19:duration=7.66,asetpts=PTS-STARTPTS[a2]; \
 [0:v]trim=start=0.19:duration=7.66,setpts=PTS-STARTPTS[v3];
 [0:a]atrim=start=0.19:duration=7.66,asetpts=PTS-STARTPTS[a3]; \
 [v0][a0][v1][a1][v2][a2][v3][a3]concat=n=4:v=1:a=1[final]" \
-map "[final]" output.mp4

open output.mp4
```







---

OLD NOTES

---

got this answer from [here](https://stackoverflow.com/a/42750147/102401), but it isn't precise.




- Create the video with some padding at the start and end. 

- Create a demuxer file named `list.txt` that looks like this:

    file INPUT_FILE.mp4
    inpoint 0.02
    output 7.23
    file INPUT_FILE.mp4
    inpoint 0.02
    output 7.23
    
- Run the demuxer with:

    ffmpeg -y -f concat -i list.txt output.mp4
    
    
- You'll have to play around with the inpoint and outpoint settings. 

- Once you get one you can copy and paste for the full length of a tik tok video (3 min at the time of this writing)

- The demux process takes some time. Use a low resolution file for figuring out the timing (since all you need is the audio), then switch to the full resolution one when you have the timing down

- The `-y` in the ffmepg command tells it to overwrite the file if it exists. Otherwise, it would ask you for confirmation every time.